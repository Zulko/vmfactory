<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Getting started &mdash; vmfactory 0.1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="vmfactory 0.1.0 documentation" href="index.html" />
    <link rel="next" title="Examples of scripts" href="examples_scripts.html" />
    <link rel="prev" title="Installation" href="installation.html" />
   
  <link href="//fonts.googleapis.com/css?family=Open+Sans:400|Antic+Slab" rel="stylesheet" type="text/css">
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body>
  
  

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="examples_scripts.html" title="Examples of scripts"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">vmfactory 0.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="getting-started">
<span id="id1"></span><h1>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<p><tt class="docutils literal"><span class="pre">vmfactory</span></tt> is written to make it easy to design, generate, vizualize and store Viennese Mazes. In a typical script, we generate or load a canvas (a maze without colors), we initialize it with random colors, we optimize these colors to make the maze difficult/interesting, we generate a report and we save the maze (maybe we will want to improve it later):</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="c"># This is a simple script to automatically design a maze:</span>
    
<span class="kn">from</span> <span class="nn">vmfactory</span> <span class="kn">import</span> <span class="n">Vmaze_NHT</span>
<span class="kn">from</span> <span class="nn">vmfactory.canvas</span> <span class="kn">import</span> <span class="n">squares_grid</span>

<span class="n">canvas</span> <span class="o">=</span> <span class="n">squares_grid</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="c"># nodes will be numbered 0..15</span>
<span class="c"># NHT means no half-turns (can&#39;t pass a light twice in a row) </span>
<span class="n">maze</span> <span class="o">=</span> <span class="n">Vmaze_NHT</span><span class="p">(</span><span class="n">canvas</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">goal</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">maze</span><span class="o">.</span><span class="n">colorize</span><span class="p">(</span> <span class="n">maze</span><span class="o">.</span><span class="n">random_colors</span><span class="p">()</span> <span class="p">)</span>
<span class="n">maze</span><span class="o">.</span><span class="n">anneal</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span> <span class="c"># optimize the maze</span>
<span class="n">maze</span><span class="o">.</span><span class="n">make_report</span><span class="p">()</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;myreport.png&#39;</span><span class="p">)</span>
<span class="n">maze</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s">&#39;my_nice_maze.vm&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>Here is a resulting report:</p>
<img alt="_images/report.jpeg" class="align-center" src="_images/report.jpeg" />
<div class="section" id="generating-a-canvas">
<h2>Generating a canvas<a class="headerlink" href="#generating-a-canvas" title="Permalink to this headline">¶</a></h2>
<p>The module <tt class="docutils literal"><span class="pre">vmfactory.canvas</span></tt> implements several kind of canvas. We
have seen <tt class="docutils literal"><span class="pre">squares_canvas</span></tt> in the introductory example. Here is how you use other shapes such as <tt class="docutils literal"><span class="pre">diamonds</span></tt>, <tt class="docutils literal"><span class="pre">stacked_cubes</span></tt>, or <tt class="docutils literal"><span class="pre">star</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">vmfactory</span> <span class="kn">import</span> <span class="n">Vmaze_NHT</span>
<span class="kn">from</span> <span class="nn">vmfactory.canvas</span> <span class="kn">import</span> <span class="n">stacked_cubes</span>

<span class="n">maze</span> <span class="o">=</span> <span class="n">Vmaze_NHT</span><span class="p">(</span><span class="o">**</span> <span class="n">stacked_cubes</span><span class="p">()</span> <span class="p">)</span>
<span class="c"># Now you can continue like in the introductory example</span>
</pre></div>
</div>
<p>Note that by default the start and goal of the maze are the two extremities
of the maze. You can change this as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">maze</span> <span class="o">=</span> <span class="n">Vmaze_NHT</span><span class="p">(</span><span class="o">**</span> <span class="n">stacked_cubes</span><span class="p">()</span> <span class="p">)</span>
<span class="n">maze</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">maze</span><span class="o">.</span><span class="n">goal</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span> <span class="c"># some other nodes.</span>
</pre></div>
</div>
<p>You can also use a custom canvas. The simplest way is to provide the
list of edges (connexions between the nodes):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">maze</span> <span class="o">=</span> <span class="n">Vmaze_NHT</span><span class="p">(</span><span class="n">canvas</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)],</span> <span class="c"># etc.</span>
                 <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">goal</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally you can use the canvas editor, which allows you to easily define the maze and the position of the nodes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">vmfactory.canvas</span> <span class="kn">import</span> <span class="n">canvas_editor</span>
<span class="n">canvas</span> <span class="o">=</span> <span class="n">canvas_editor</span><span class="p">()</span>
<span class="n">Vmaze_NHT</span><span class="p">(</span><span class="n">canvas</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">goal</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
<p>The canvas editor provides an interface that looks like this:</p>
<img alt="_images/canvas_editor.jpeg" class="align-center" src="_images/canvas_editor.jpeg" />
<p>In a first step you must place the nodes (right click to undo). Bear in mind that the order in which you add the nodes is the order in which they will be numbered. Press Enter when finished.</p>
<p>In a first step you must draw the edges by clicking on pairs of nodes. Reclick on that pair of nodes to remove an edge. Press Enter when finished. And you are done.</p>
</div>
<div class="section" id="the-different-kind-of-mazes">
<h2>The different kind of mazes<a class="headerlink" href="#the-different-kind-of-mazes" title="Permalink to this headline">¶</a></h2>
<p>You have seen that in the previous examples we used the class
<tt class="docutils literal"><span class="pre">Vmaze_NHT</span></tt>, which represents Viennese mazes in which it is not allowed to pass by the light twice in a row. You can use the class <tt class="docutils literal"><span class="pre">Vmaze_HT</span></tt> instead, in which this rule doesn&#8217;t hold. All the programming is exactly the same, only the rule is changed.</p>
</div>
<div class="section" id="optimizing-the-maze">
<h2>Optimizing the maze<a class="headerlink" href="#optimizing-the-maze" title="Permalink to this headline">¶</a></h2>
<p>For a longer description of Viennese Mazes and how they can be programatically generated, refer to <a href="#id2"><span class="problematic" id="id3">`this blog post (not written yet)&lt;zulko.github.io&gt;`_</span></a>, or to the details in the reference manual.</p>
<p>In the current implementation, before the colors of the traffic lights of the maze are optimized, they must be set randomly:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">maze</span><span class="o">.</span><span class="n">colorize</span><span class="p">(</span> <span class="n">maze</span><span class="o">.</span><span class="n">random_colors</span><span class="p">()</span> <span class="p">)</span>
</pre></div>
</div>
<p>Then you improve this maze by changing a few colors randomly and seeing if the resulting labyrinth has a better score (see next section for the discussion on the score). If it has, it replaces the current maze.</p>
<p>The next snippet repeats this procedure 100 times, and each time each traffic light in the maze has a probability of 0.1 to be changed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">maze</span><span class="o">.</span><span class="n">improve</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">proba_change</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<p>A second way of optimizeing a maze, which is a refinement of <tt class="docutils literal"><span class="pre">improve</span></tt>, is <tt class="docutils literal"><span class="pre">anneal</span></tt>. The idea is that it first execute <tt class="docutils literal"><span class="pre">improve</span></tt> with a high value of <tt class="docutils literal"><span class="pre">proba_change</span></tt>, then it repeats <tt class="docutils literal"><span class="pre">improve</span></tt> with lower values of <tt class="docutils literal"><span class="pre">proba_change</span></tt>. The result is that, at first, many very different mazes are considered, and as we find better and better mazes, the search is limited to mazes which ressemble these mazes.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Runs 20 times maze.improve(200, p), with decreasing p.</span>
<span class="n">maze</span><span class="o">.</span><span class="n">anneal</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="changing-the-way-the-score-is-computed">
<h2>Changing the way the score is computed<a class="headerlink" href="#changing-the-way-the-score-is-computed" title="Permalink to this headline">¶</a></h2>
<p>The way the score is computed determines the criteria according to which the mazes will be optimized. Do you prefer mazes with a lot of loops ? Or mazes whose solution is very long ? Or mazes that are difficult to solve both forwards and backwards ? The way the score is computed must reflect all these criteria.</p>
<p>The score of a maze is computed using the method <tt class="docutils literal"><span class="pre">vmaze.compute_score()</span></tt>.
The default score is computed as follows: if there is no solutions it will be 0, if there are solutions (not just one), it will be 1. If there is a unique solution, what we want, it will be (roughly) the product of the length of this solution, the number of loops in the maze, and the number of openings and endings.</p>
<p>If you want to use your own way of computing the score, you must create a subclass of <tt class="docutils literal"><span class="pre">Vmaze_NHT</span></tt> or <tt class="docutils literal"><span class="pre">Vmaze_HT</span></tt> (depending on which rules you want) and overwrite the <tt class="docutils literal"><span class="pre">compute_score</span></tt> method, like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Vmaze_NHT_long</span><span class="p">(</span><span class="n">Vmaze_NHT</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; A class that will tend to optimize mazes so that</span>
<span class="sd">        their solution is very long. The unicity of the</span>
<span class="sd">        solution is not granted. &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">compute_score</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; See the introductory blog post for infos. &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_graph</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span> <span class="k">return</span> <span class="mi">0</span>
        <span class="n">shortest</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">shortest_path</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="n">goal</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">shortest</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">shortest</span><span class="p">[</span><span class="n">graph</span><span class="o">.</span><span class="n">goal</span><span class="p">])</span>
</pre></div>
</div>
<p>Now just use <tt class="docutils literal"><span class="pre">Vmaze_NHT_long</span></tt> instead of <tt class="docutils literal"><span class="pre">Vmaze_NHT</span></tt> in your scripts.</p>
</div>
<div class="section" id="making-a-report">
<h2>Making a report<a class="headerlink" href="#making-a-report" title="Permalink to this headline">¶</a></h2>
<p>With this package and a simple <tt class="docutils literal"><span class="pre">for</span></tt> loop you can produce thousands of mazes per day, but how do you quicly vizualize and assess the interestingness of a maze. Most of the time, the score is not enough, so <tt class="docutils literal"><span class="pre">vmfactory</span></tt> provides many functions to nicely plot the maze (<tt class="docutils literal"><span class="pre">maze.draw_fancy</span></tt>), plot its state graph (<tt class="docutils literal"><span class="pre">maze.draw_graph</span></tt>) or plot its solution(<tt class="docutils literal"><span class="pre">maze.draw_solution</span></tt>). See the documentation of each of these methods for more details.</p>
<p>You can also do all this at once and generate a full report for a given maze as follows (some options available, see the docs):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">fig</span> <span class="o">=</span> <span class="n">maze</span><span class="o">.</span><span class="n">make_report</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;report.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>It will give you this:</p>
<img alt="_images/report.jpeg" class="align-center" src="_images/report.jpeg" />
</div>
<div class="section" id="saving-loading-a-maze">
<h2>Saving / loading a maze<a class="headerlink" href="#saving-loading-a-maze" title="Permalink to this headline">¶</a></h2>
<p>The easiest way to do save/load a Viennese maze is as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># The following line saves</span>
<span class="n">maze</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s">&#39;my_nice_maze.vm&#39;</span><span class="p">)</span>

<span class="c"># later</span>
<span class="n">maze</span> <span class="o">=</span> <span class="n">Vmaze_NHT</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s">&#39;my_nice_maze.vm&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You could also <em>save</em> you mazes in plain text. A convenient way to do so is to print the maze:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</pre></div>
</div>
<p>Result:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
  <span class="s">&#39;start&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>

  <span class="s">&#39;goal&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>

  <span class="s">&#39;canvas&#39;</span> <span class="p">:[</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)],</span>

  <span class="s">&#39;nodes_pos&#39;</span><span class="p">:[</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]}</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
  
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo_small.jpeg" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Getting started</a><ul>
<li><a class="reference internal" href="#generating-a-canvas">Generating a canvas</a></li>
<li><a class="reference internal" href="#the-different-kind-of-mazes">The different kind of mazes</a></li>
<li><a class="reference internal" href="#optimizing-the-maze">Optimizing the maze</a></li>
<li><a class="reference internal" href="#changing-the-way-the-score-is-computed">Changing the way the score is computed</a></li>
<li><a class="reference internal" href="#making-a-report">Making a report</a></li>
<li><a class="reference internal" href="#saving-loading-a-maze">Saving / loading a maze</a></li>
</ul>
</li>
</ul>
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="installation.html" title="previous chapter">Installation</a></li>
      <li>Next: <a href="examples_scripts.html" title="next chapter">Examples of scripts</a></li>
  </ul></li>
</ul>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/getting_started.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="examples_scripts.html" title="Examples of scripts"
             >next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             >previous</a> |</li>
        <li><a href="index.html">vmfactory 0.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" style="position:relative">
      &copy; Copyright 2014, Zulko.
    </div>
    <div>

    </div>

  </body>
</html>